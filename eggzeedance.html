<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üíÉ Eggzee Dance Scene</title>

  <!-- CreateJS runtime -->
  <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
  <!-- Animate export -->
  <script src="eggzeedanceworks.js"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background-color: black;
      touch-action: none; /* üö´ disables pinch-zoom and drag */
    }
html, body {
  margin: 0;
  padding: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  background-color: black;
  touch-action: none; /* prevent pinch-zoom */
}
canvas {
  image-rendering: auto;
}
#animation_container, #canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: black;
}


  </style>
</head>

<body onload="init();">
  <div id="animation_container">
    <canvas id="canvas"></canvas>
  </div>

<script>
let canvas, stage, exportRoot, comp, lib, bg;

function init() {
  console.log("üé¨ Starting Eggzee Dance...");
  canvas = document.getElementById("canvas");
  comp = AdobeAn.getComposition("1204F486BCA4BF4E9AA6F7C9DE17DD26");
  lib = comp.getLibrary();

  const loader = new createjs.LoadQueue(false);
  loader.addEventListener("fileload", (evt) => {
    if (evt.item.type === "image") {
      comp.getImages()[evt.item.id] = evt.result;
    }
  });
  loader.addEventListener("complete", handleComplete);
  loader.loadManifest(lib.properties.manifest);
}

function handleComplete() {
  exportRoot = new lib.eggzeedanceworks();
  stage = new lib.Stage(canvas);

  // ü™© Load dancefloor background
  const bgImage = new Image();
  bgImage.src = "assets/dancefloor1.png";
  bgImage.onload = function () {
    bg = new createjs.Bitmap(bgImage);
    stage.addChild(bg);
    stage.addChild(exportRoot);

    resizeCanvas(); // ‚úÖ moved here (runs once background is ready)
    window.addEventListener("resize", resizeCanvas);
  };

  AdobeAn.compositionLoaded(lib.properties.id);
  createjs.Ticker.framerate = lib.properties.fps;
  createjs.Ticker.addEventListener("tick", stage);
}




function resizeCanvas() {
  const w = window.innerWidth;
  const h = window.innerHeight;
  canvas.width = w;
  canvas.height = h;

  if (!bg) return;

  const designW = lib.properties.width;
  const designH = lib.properties.height;
  const isMobile = /Mobi|Android|iPhone|iPad/i.test(navigator.userAgent);

  // ü™© Background scaling
  let scaleX = w / bg.image.width;
  let scaleY = h / bg.image.height;
  let scale;

  // üì± Mobile ‚Üí contain (show full image)
  // üñ•Ô∏è Desktop ‚Üí cover (fill whole screen, no black)
  if (isMobile) {
  scale = Math.min(scaleX, scaleY) * 1.12; // zoom a bit on mobile
} else {
  scale = Math.min(scaleX, scaleY); // ‚úÖ show full image on desktop
}


  bg.scaleX = bg.scaleY = scale;
  bg.x = (w - bg.image.width * scale) / 2;
  bg.y = (h - bg.image.height * scale) / 2;

  // üê£ Center & scale Eggzee animation
  const animScale = Math.min(w / designW, h / designH);
  exportRoot.scaleX = exportRoot.scaleY = animScale;
  exportRoot.x = (w - designW * animScale) / 2;
  exportRoot.y = (h - designH * animScale) / 2;

  // üé¨ Stage covers the whole canvas
  stage.scaleX = stage.scaleY = 1;
  stage.x = 0;
  stage.y = 0;
}




</script>




    <!-- ü©∑ Return to Menu Button -->
  <button id="returnBtn"
    style="position:fixed; bottom:20px; right:20px; padding:12px 18px; font-size:18px;
    border:none; border-radius:10px; background:#ffd6e0; color:#333; cursor:pointer;">
    ‚¨ÖÔ∏è Return to Menu
  </button>

 <script>
  function closeDance() {
    // üíæ Remember Eggzee‚Äôs awake state
    localStorage.setItem("eggzeeForceAwake", "true");

    // üïäÔ∏è Always go back to main menu (works on mobile + GitHub Pages)
    window.location.href = "index.html";
  }

  // ü©∑ Make sure the button actually triggers
  document.getElementById("returnBtn").addEventListener("click", closeDance);

  // ü©µ Fade-in effect for button
  const btn = document.getElementById("returnBtn");
  btn.style.opacity = "0";
  setTimeout(() => {
    btn.style.transition = "opacity 1s ease";
    btn.style.opacity = "1";
  }, 2000);
</script>


</body>
</html>















